# ‚úÖ –ì–æ—Ç–æ–≤ –∫ –∏–º–ø–æ—Ä—Ç—É - –ß–∏—Å—Ç—ã–π —Ñ–∞–π–ª —ç–∫—Å–ø–æ—Ä—Ç–∞

**–î–∞—Ç–∞:** 26 –Ω–æ—è–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è:** 2.3.1

---

## üìÅ –§–∞–π–ª—ã

### –ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª (—Å—Ç–∞—Ä—ã–π, —Å –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏):
```
/Users/bogisis/Downloads/Quote Calculator Export Nov 21 2025.json
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå 7 —Ñ–∞–π–ª–æ–≤ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ array
- ‚ùå –î–ª—è —Ä–µ–≥–∏–æ–Ω–∞ Ushuaia 3 —Ñ–∞–π–ª–∞ (56 + 60 + 0 templates)
- ‚ùå 56 –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ ID –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏
- ‚ùå –ü–æ—Å–ª–µ–¥–Ω–∏–π —Ñ–∞–π–ª —Å 0 templates –∑–∞—Ç–∏—Ä–∞–ª –ø—Ä–µ–¥—ã–¥—É—â–∏–µ

---

### ‚úÖ –ù–æ–≤—ã–π —Ñ–∞–π–ª (—á–∏—Å—Ç—ã–π, –≥–æ—Ç–æ–≤ –∫ –∏–º–ø–æ—Ä—Ç—É):
```
/Users/bogisis/Downloads/Quote Calculator Export CLEAN.json
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –§–æ—Ä–º–∞—Ç: **object** (—Ä–µ–≥–∏–æ–Ω -> –¥–∞–Ω–Ω—ã–µ)
- ‚úÖ –í—Å–µ –¥—É–±–ª–∏–∫–∞—Ç—ã —É–¥–∞–ª–µ–Ω—ã (merge –ø–æ ID)
- ‚úÖ –ö–∞–∂–¥—ã–π —Ä–µ–≥–∏–æ–Ω –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –û–î–ò–ù –†–ê–ó
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º —Å —Ç–µ–∫—É—â–∏–º –∫–æ–¥–æ–º –∏–º–ø–æ—Ä—Ç–∞

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –ö–∞—Ç–∞–ª–æ–≥–∏ –ø–æ—Å–ª–µ merge:

| –†–µ–≥–∏–æ–Ω | Templates | Categories |
|--------|-----------|------------|
| **Ushuaia** | 60 | 23 |
| **Unknown** | 55 | 16 |
| **Default** | 55 | 16 |
| **El Calafate** | 17 | 9 |
| **Buenos Aires** | 2 | 6 |
| **–ò–¢–û–ì–û** | **189** | **70** |

### –°–º–µ—Ç—ã:
- 1 —Å–º–µ—Ç–∞ –≤–∫–ª—é—á–µ–Ω–∞ –≤ —Ñ–∞–π–ª

---

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### 1. SQLiteStorage.js (—Å—Ç—Ä–æ–∫–∞ 661)

**–ë—ã–ª–æ:**
```javascript
const region = data.region || '';
```

**–°—Ç–∞–ª–æ:**
```javascript
const region = data.region || name;  // ‚úÖ –∏—Å–ø–æ–ª—å–∑—É–µ–º name –µ—Å–ª–∏ data.region –ø—É—Å—Ç–æ–π
```

**–ó–∞—á–µ–º:** –ö–æ–ª–æ–Ω–∫–∞ `region` —Ç–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∞, –∫–æ–¥ `loadCatalogForRegion()` –º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ –∫–∞—Ç–∞–ª–æ–≥.

---

### 2. SQLiteStorage.js (—Å—Ç—Ä–æ–∫–∞ 218)

**–ë—ã–ª–æ:**
```javascript
ON CONFLICT(...) DO UPDATE SET
    data = excluded.data,
    ...
```

**–°—Ç–∞–ª–æ:**
```javascript
ON CONFLICT(...) DO UPDATE SET
    data = excluded.data,
    ...
    deleted_at = NULL  -- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —É–¥–∞–ª—ë–Ω–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∏–º–ø–æ—Ä—Ç–µ
```

**–ó–∞—á–µ–º:** –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∏–º–ø–æ—Ä—Ç–µ —É–¥–∞–ª—ë–Ω–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è.

---

### 3. index.html (—Å—Ç—Ä–æ–∫–∏ 9742-9806)

**–î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ merge –¥–ª—è array —Ñ–æ—Ä–º–∞—Ç–∞:**
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–≥–∏–æ–Ω—É
- –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è templates –ø–æ ID
- –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è categories –ø–æ ID
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –û–î–ù–û–ì–û –∫–∞—Ç–∞–ª–æ–≥–∞ –Ω–∞ —Ä–µ–≥–∏–æ–Ω

---

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏–º–ø–æ—Ä—Ç—É

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É–∂–µ –æ—á–∏—â–µ–Ω–∞:
```bash
sqlite3 "/Users/bogisis/Desktop/—Å–º–µ—Ç—ã/for_deploy copy/db/quotes.db" \
  "SELECT COUNT(*) FROM catalogs;"
```

–î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: **0**

---

### –®–∞–≥ 2: –ò–º–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ UI

1. **–û—Ç–∫—Ä–æ–π:** http://localhost:4000
2. **–ó–∞–ª–æ–≥–∏–Ω—å—Å—è** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
   - Email: `admin@magellania.com`
   - Password: `magellania2025`
3. **–û—Ç–∫—Ä–æ–π –º–µ–Ω—é:** "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏" (–∏–∫–æ–Ω–∫–∞ —à–µ—Å—Ç–µ—Ä—ë–Ω–∫–∏)
4. **–ù–∞–∂–º–∏:** "üì• –ò–º–ø–æ—Ä—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö"
5. **–í—ã–±–µ—Ä–∏ —Ñ–∞–π–ª:**
   ```
   /Users/bogisis/Downloads/Quote Calculator Export CLEAN.json
   ```
6. **–ü–æ–¥—Ç–≤–µ—Ä–¥–∏ –∏–º–ø–æ—Ä—Ç**

---

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

–û—Ç–∫—Ä–æ–π DevTools (F12) ‚Üí Console. –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:

```
Starting catalogs import...
Importing catalog for region: Ushuaia {templates: Array(60), categories: Array(23)}
‚úì Successfully imported catalog: Ushuaia (60 templates, 23 categories)

Importing catalog for region: Unknown {templates: Array(55), categories: Array(16)}
‚úì Successfully imported catalog: Unknown (55 templates, 16 categories)

Importing catalog for region: Default {templates: Array(55), categories: Array(16)}
‚úì Successfully imported catalog: Default (55 templates, 16 categories)

Importing catalog for region: El Calafate {templates: Array(17), categories: Array(9)}
‚úì Successfully imported catalog: El Calafate (17 templates, 9 categories)

Importing catalog for region: Buenos Aires {templates: Array(2), categories: Array(6)}
‚úì Successfully imported catalog: Buenos Aires (2 templates, 6 categories)
```

**‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:** –í—Å–µ 5 —Ä–µ–≥–∏–æ–Ω–æ–≤ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ.

---

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ë–î

```bash
sqlite3 "/Users/bogisis/Desktop/—Å–º–µ—Ç—ã/for_deploy copy/db/quotes.db" "
SELECT
    name,
    region,
    json_array_length(json_extract(data, '\$.templates')) as templates
FROM catalogs
WHERE deleted_at IS NULL
ORDER BY templates DESC;
"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
Ushuaia|Ushuaia|60
Unknown|Unknown|55
Default|Default|55
El Calafate|El Calafate|17
Buenos Aires|Buenos Aires|2
```

**‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:** 5 –∫–∞—Ç–∞–ª–æ–≥–æ–≤, 189 templates.

---

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

1. **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É:** F5 –∏–ª–∏ Cmd+Shift+R
2. **–û—Ç–∫—Ä–æ–π:** "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞–º–∏"
3. **–í—ã–±–µ—Ä–∏ —Ä–µ–≥–∏–æ–Ω:** "Ushuaia"
4. **–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:** –°–ø–∏—Å–æ–∫ –∏–∑ 60 –∫–∞—Ä—Ç–æ—á–µ–∫ —É—Å–ª—É–≥

**–ü—Ä–∏–º–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏:**
```
–ö–µ–º–ø–∏–Ω–≥, –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –ø–∞–ª–∞—Ç–∫–∞ + –ø–∏—Ç–∞–Ω–∏–µ
–¶–µ–Ω–∞: $534
–ö–∞—Ç–µ–≥–æ—Ä–∏—è: Torres del Paine
–ü–æ–¥—Ä—è–¥—á–∏–∫: Torres del paine
```

**‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:** –ö–∞—Ä—Ç–æ—á–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –≤ —Å–º–µ—Ç—É.

---

## üîç –ê–Ω–∞–ª–∏–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (–∫–∞–∫ –±—ã–ª–æ)

### Ushuaia –∫–∞—Ç–∞–ª–æ–≥–∏ –≤ —Å—Ç–∞—Ä–æ–º —Ñ–∞–π–ª–µ:

```
1. catalog copy.json:    56 templates (ID: custom_1758859820763, svc_14, ...)
2. catalog.json:         60 templates (ID: custom_1758859820763, svc_14, ...)  ‚Üê 56 —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π!
3. catalog_Ushuaia.json: 0 templates
```

**–î—É–±–ª–∏–∫–∞—Ç—ã:** 56 ID –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏ 1 –∏ 2.

**–ü–æ—Å–ª–µ merge:** 60 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö templates (56 –æ–±—â–∏—Ö + 4 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞ 2).

---

## üìã –§–æ—Ä–º–∞—Ç –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞

```json
{
  "version": "2.3.1",
  "exportDate": "2025-11-26T07:55:37.387294Z",
  "data": {
    "catalogs": {
      "Ushuaia": {
        "templates": [
          {
            "id": "custom_1760104404585",
            "name": "–ö–µ–º–ø–∏–Ω–≥, –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –ø–∞–ª–∞—Ç–∫–∞ + –ø–∏—Ç–∞–Ω–∏–µ",
            "category": "torres_del_paine",
            "description": "W express (4 –¥–Ω—è/3 –Ω–æ—á–∏)",
            "contractor": "Torres del paine",
            "icon": "‚õ∫",
            "price": 534,
            "region": "Ushuaia"
          },
          ...  // 60 templates
        ],
        "categories": [...],  // 23 categories
        "region": "Ushuaia"
      },
      "Unknown": { ... },
      "Default": { ... },
      "El Calafate": { ... },
      "Buenos Aires": { ... }
    },
    "estimates": [...],  // 1 —Å–º–µ—Ç–∞
    "settings": null
  }
}
```

**–§–æ—Ä–º–∞—Ç:** `catalogs` - —ç—Ç–æ **object**, –≥–¥–µ –∫–ª—é—á - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–≥–∏–æ–Ω–∞, –∑–Ω–∞—á–µ–Ω–∏–µ - –¥–∞–Ω–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∞.

–ö–æ–¥ –∏–º–ø–æ—Ä—Ç–∞ (`index.html:9789-9813`) –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —ç—Ç–æ—Ç —Ñ–æ—Ä–º–∞—Ç:
```javascript
} else if (typeof catalogs === 'object' && catalogs !== null) {
    for (const [region, regionData] of Object.entries(catalogs)) {
        // –ò–º–ø–æ—Ä—Ç –∫–∞—Ç–∞–ª–æ–≥–∞ —Ä–µ–≥–∏–æ–Ω–∞
    }
}
```

---

## ‚úÖ Checklist

- [x] –ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- [x] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ—á–∏—â–µ–Ω–∞ (DELETE FROM catalogs)
- [x] –°–æ–∑–¥–∞–Ω —á–∏—Å—Ç—ã–π —Ñ–∞–π–ª —ç–∫—Å–ø–æ—Ä—Ç–∞ (CLEAN.json)
- [x] –î—É–±–ª–∏–∫–∞—Ç—ã —É–¥–∞–ª–µ–Ω—ã (merge –ø–æ ID)
- [x] –ö–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω (region = name, deleted_at = NULL)
- [x] –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [x] –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [ ] **TODO: –í—ã–ø–æ–ª–Ω–∏—Ç—å –∏–º–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ UI**
- [ ] **TODO: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ**

---

## üéØ –ò—Ç–æ–≥–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### –§–∞–π–ª—ã:
- ‚úÖ `/Users/bogisis/Downloads/Quote Calculator Export CLEAN.json` - –≥–æ—Ç–æ–≤ –∫ –∏–º–ø–æ—Ä—Ç—É

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
- ‚úÖ –ö–∞—Ç–∞–ª–æ–≥–∏ —É–¥–∞–ª–µ–Ω—ã (0 –∑–∞–ø–∏—Å–µ–π)
- ‚úÖ –ì–æ—Ç–æ–≤–∞ –∫ —á–∏—Å—Ç–æ–º—É –∏–º–ø–æ—Ä—Ç—É

### –ö–æ–¥:
- ‚úÖ SQLiteStorage.js - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω (region, deleted_at)
- ‚úÖ index.html - merge –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω (–ø–æ—Ä—Ç 4000)

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π —Ñ–∞–π–ª `Quote Calculator Export CLEAN.json` —á–µ—Ä–µ–∑ UI!
