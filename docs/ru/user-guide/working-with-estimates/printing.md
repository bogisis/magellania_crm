# Печать и экспорт

**Версия:** 2.3.0

## Печать (Ctrl+P)

### Быстрая печать

```
1. Открыть смету
2. Нажать Ctrl+P (или кнопку "Печать")
3. Настроить параметры в диалоге браузера
4. Нажать "Печать" или "Сохранить как PDF"
```

---

## Что попадает в печать

### ✅ Показывается клиенту

- Информация о клиенте (имя, контакты)
- Параметры группы (PAX, даты, длительность)
- Список услуг с названиями
- Итоговые цены услуг (с наценками)
- Общая стоимость тура
- Условия и примечания

### ❌ НЕ показывается клиенту

- Скрытая наценка
- Процент индивидуальных наценок
- Базовые цены (до наценок)
- Внутренние расчёты прибыли
- Маржа
- ID и метаданные

---

## Настройки печати

### Рекомендуемые параметры

```
Ориентация: Портретная
Размер бумаги: A4
Масштаб: 100%
Поля: По умолчанию
Цвет: Цветная (для логотипов)
Качество: Высокое
```

### Диалог браузера

```
Chrome/Edge:
  Назначение: Принтер или "Сохранить как PDF"
  Страницы: Все
  Макет: Портретная
  Параметры: Фоновая графика ✓

Firefox:
  Файл → Печать
  Аналогичные настройки

Safari:
  Файл → Печать
  PDF → Сохранить как PDF
```

---

## Сохранение в PDF

### Способ 1: Через диалог печати

```
1. Ctrl+P
2. Назначение: "Сохранить как PDF"
3. Выбрать папку
4. Имя файла: {клиент}_tour_{дата}.pdf
5. Сохранить
```

### Способ 2: Браузерное меню

**Chrome:**
```
⋮ → Печать → Сохранить как PDF
```

**Firefox:**
```
☰ → Печать → Сохранить в PDF
```

**Safari:**
```
Файл → Экспорт как PDF
```

---

## Экспорт данных

### JSON (полный экспорт)

```
1. Меню → Экспорт → JSON
2. Сохраняется файл: {название}.json
3. Содержит ВСЕ данные (включая внутренние)
```

**Использование:**
- Backup
- Обмен с коллегами
- Импорт на другом компьютере
- Архивирование

### CSV (только данные)

```
Не поддерживается для смет
Доступен только для каталогов
```

---

## Форматирование

### Структура печатной версии

```
┌─────────────────────────────────────┐
│ КОММЕРЧЕСКОЕ ПРЕДЛОЖЕНИЕ            │
├─────────────────────────────────────┤
│ Клиент: Иванов Пётр Сергеевич      │
│ Телефон: +7 (999) 123-45-67        │
│ Email: ivanov@example.com          │
├─────────────────────────────────────┤
│ Параметры группы:                   │
│ Количество туристов: 10 человек     │
│ Даты: 15.12.2025 - 22.12.2025     │
│ Длительность: 7 дней / 6 ночей     │
├─────────────────────────────────────┤
│ УСЛУГИ                              │
│                                     │
│ 1. Трансфер аэропорт→отель  $110   │
│ 2. Отель 4* (DBL, 6 ночей)  $528   │
│ 3. Экскурсия обзорная       $345   │
│ 4. Гид (3 дня)              $495   │
├─────────────────────────────────────┤
│ ИТОГО: $1,478                       │
├─────────────────────────────────────┤
│ Условия:                            │
│ - Оплата 50% при бронировании       │
│ - Остаток за 7 дней до выезда       │
│ - Отмена бесплатно за 14 дней       │
└─────────────────────────────────────┘
```

---

## Пользовательские настройки

### Логотип и брендинг

**В будущих версиях:**
```
Настройки → Брендинг
- Загрузить логотип
- Цвета компании
- Контактная информация
```

**Сейчас:** Добавьте вручную в HTML/CSS

### Условия и примечания

```
Поле "Примечания" в форме клиента
Попадает в печать автоматически
```

---

## Отправка клиенту

### Email

```
1. Сохранить как PDF
2. Открыть почтовый клиент
3. Прикрепить файл
4. Тема: "КП - {Название тура}"
5. Отправить
```

### Мессенджеры

```
WhatsApp / Telegram:
1. Сохранить как PDF
2. Открыть чат с клиентом
3. Прикрепить файл
4. Отправить
```

### Печатная копия

```
1. Ctrl+P
2. Выбрать принтер
3. Печать
4. Передать клиенту лично
```

---

## Массовая печать

### Печать нескольких смет

```
1. Открыть первую смету
2. Ctrl+P → Сохранить как PDF
3. Повторить для остальных
```

**Автоматизация (через API):**
```bash
#!/bin/bash
for id in est_001 est_002 est_003; do
  curl http://localhost:4000/api/estimates/$id > $id.json
  # Конвертация в PDF через headless browser
done
```

---

## Качество печати

### Оптимизация

```
DPI: 300 (высокое качество)
Шрифты: Web-safe fonts
Изображения: Векторные (SVG) где возможно
Цвета: RGB для экрана, CMYK для печати
```

### Проблемы и решения

**Обрезается контент:**
```
→ Уменьшить масштаб до 90%
→ Или выбрать альбомную ориентацию
```

**Нет фонов/графики:**
```
→ Включить "Фоновая графика" в настройках печати
```

**Неправильные шрифты:**
```
→ Проверить установленные шрифты
→ Использовать web-safe альтернативы
```

---

## API для печати

### Прямая печать через API

```bash
# Получить данные
curl http://localhost:4000/api/estimates/est_001

# Экспорт в JSON
curl http://localhost:4000/api/export/all > backup.json
```

### Headless printing (advanced)

```javascript
// Puppeteer example
const puppeteer = require('puppeteer');

async function printEstimate(estimateId) {
  const browser = await puppeteer.launch();
  const page = await browser.newPage();

  await page.goto(`http://localhost:4000?estimate=${estimateId}`);
  await page.pdf({
    path: `${estimateId}.pdf`,
    format: 'A4',
    printBackground: true
  });

  await browser.close();
}
```

---

## Checklist перед печатью

- [ ] Проверены все данные клиента
- [ ] PAX и даты корректны
- [ ] Все услуги на месте
- [ ] Наценки настроены
- [ ] Итоговая сумма правильная
- [ ] Скрытые поля не показываются
- [ ] Примечания и условия добавлены
- [ ] Формат PDF выбран правильно

---

**Назад:** [← Расчёты](calculations.md)
**Следующий раздел:** [Catalogs →](../catalogs/index.md)
