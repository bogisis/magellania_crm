# Quote Calculator - Environment Variables
# Copy this file to .env and configure for your environment

# ============================================================================
# Server Configuration
# ============================================================================

# Server port (default: 4000 for v3.0)
PORT=4000

# Node environment (development, production, test)
NODE_ENV=development

# ============================================================================
# Storage Configuration
# ============================================================================

# Storage type: 'file' or 'sqlite'
# - file: Current file-based storage (estimate/, backup/, catalog/)
# - sqlite: New SQLite database storage (db/quotes.db)
STORAGE_TYPE=file

# Database path (only for sqlite storage)
# Default: db/quotes.db
DB_PATH=db/quotes.db

# ============================================================================
# Migration Configuration
# ============================================================================

# Dual-write mode (write to both file and sqlite during migration period)
# Options: true, false
# When true, all saves go to both storages for safety
DUAL_WRITE_MODE=false

# ============================================================================
# File Storage Paths (only for file storage type)
# ============================================================================

# Directories for file-based storage
ESTIMATE_DIR=estimate
BACKUP_DIR=backup
CATALOG_DIR=catalog
SETTINGS_DIR=settings

# ============================================================================
# Feature Flags
# ============================================================================

# Enable audit logging (for future undo/redo)
ENABLE_AUDIT_LOG=true

# Enable optimistic locking (for concurrent edits protection)
ENABLE_OPTIMISTIC_LOCKING=true

# ============================================================================
# Performance
# ============================================================================

# JSON payload size limit (default: 50mb)
JSON_LIMIT=50mb

# Request timeout in milliseconds (default: 30000 = 30 seconds)
REQUEST_TIMEOUT=30000

# ============================================================================
# Logging (Winston)
# ============================================================================

# Log level: debug, info, warn, error
LOG_LEVEL=info

# Console logging (true/false) - для development
LOG_CONSOLE=true

# Enable SQL query logging (for development)
LOG_SQL_QUERIES=false

# ============================================================================
# Notes
# ============================================================================

# Migration workflow:
# 1. Keep STORAGE_TYPE=file (current state)
# 2. Run migration: npm run migrate:dry-run
# 3. Run real migration: npm run migrate:run
# 4. Test with dual-write: STORAGE_TYPE=file, DUAL_WRITE_MODE=true
# 5. Switch to SQLite: STORAGE_TYPE=sqlite
# 6. Disable dual-write: DUAL_WRITE_MODE=false
# 7. Verify and backup: cp db/quotes.db db/quotes.backup.db
